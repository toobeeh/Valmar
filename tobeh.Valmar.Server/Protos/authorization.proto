syntax = "proto3";

import "google/protobuf/timestamp.proto";

option csharp_namespace = "tobeh.Valmar";
package authorization;

// Service definition for authorization
service Authorization {

  // Gets all available scopes
  rpc GetAvailableScopes (GetAvailableScopesMessage) returns (stream ScopeMessage);

  // Create a jwt with given parameters
  rpc CreateJwt (JwtParametersMessage) returns (JwtMessage);
}

message GetAvailableScopesMessage {}

message ScopeMessage {
  string name = 1;
  string description = 2;
}

message JwtParametersMessage {
  int32 typoId = 1;
  repeated string scopes = 2;
  google.protobuf.Timestamp expiry = 3;
  string applicationName = 4;
  string redirectUri = 5;
}

message JwtMessage {
  string jwt = 1;
  int32 typoId = 2;
}
